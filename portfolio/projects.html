<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PROJECTS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--  Stylesheets  -->
    <link rel="stylesheet" href="../css/privacy.css">
    <link rel="stylesheet" href="../css/portfolioStyles.css">
    <link rel="stylesheet" href="../css/portStylesCont.css">

    <!--  React CDN imports  -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

</head>

<body>

    <div id="root"></div>

    <script type="text/babel">

        function Navbar({ activePage }) {
            return (
                <header className="top-nav">
                    <nav className="nav-tabs">
                        <a href="aboutMe.html" className="nav-link">ABOUT ME</a>
                        <a href="portSkills.html" className="nav-link">SKILLS</a>
                        <a href="projects.html" className="nav-link active">PROJECTS</a>
                    </nav>
                </header>
            );
        }

        function ProjectCard({ title, subtitle, variant, body }) {
            const [open, setOpen] = React.useState(false);
            const cardRef = React.useRef(null);

            React.useEffect(() => {
                if (open && cardRef.current) {
                    const nav = document.querySelector(".top-nav");
                    const offset = nav ? nav.offsetHeight + 16 : 16;
                    const rect = cardRef.current.getBoundingClientRect();
                    const scrollTop = window.scrollY + rect.top - offset;
                    window.scrollTo({ top: scrollTop, behavior: "smooth" });
                }
            }, [open]);

            return (
                <div ref={cardRef} className={`project-card ${variant} ${open ? "expanded" : "collapsed"}`}>
                    <div className="project-header" onClick={() => setOpen(!open)}>
                        <div className="project-label">{title}</div>
                        <button className="project-toggle">
                            {subtitle}
                            <span className="chevron">{"▲"}</span>
                        </button>
                    </div>

                    <div className="project-body">
                        {body}
                    </div>
                </div>
            );
        }

        function Carousel({ images }) {
            const [index, setIndex] = React.useState(0);
            const [lightboxIndex, setLightboxIndex] = React.useState(null);

            const prev = () => setIndex((index - 1 + images.length) % images.length);
            const next = () => setIndex((index + 1) % images.length);

            return (
                <div className="carousel">
                    <img
                        src={images[index]}
                        alt="carousel item"
                        className="carousel-img"
                        onClick={() => setLightboxIndex(index)}
                        style={{ cursor: "pointer" }}
                    />

                    <button className="carousel-btn left" onClick={prev}>‹</button>
                    <button className="carousel-btn right" onClick={next}>›</button>

                    <div className="carousel-dots">
                        {images.map((_, i) => (
                          <div
                            key={i}
                            className={`dot ${i === index ? "active" : ""}`}
                            onClick={() => setIndex(i)}
                          />
                        ))}
                    </div>

                    <Lightbox
                        images={images}
                        index={lightboxIndex}
                        setIndex={setLightboxIndex}
                        onClose={() => setLightboxIndex(null)}
                    />
                </div>
            );
        }

        function Lightbox({ images, index, onClose, setIndex }) {
            if (index === null) return null;

            const prev = () => setIndex((index - 1 + images.length) % images.length);
            const next = () => setIndex((index + 1) % images.length);

            return (
                <div className="lightbox-backdrop open" onClick={onClose}>
                    <div
                        className="lightbox-content"
                        onClick={e => e.stopPropagation()}
                    >
                        <img src={images[index]} className="lightbox-img" alt="lightbox image"/>

                        <button className="lightbox-btn left" onClick={prev}>‹</button>
                        <button className="lightbox-btn right" onClick={next}>›</button>

                        <button className="lightbox-close" onClick={onClose}>×</button>
                    </div>
                </div>
            );
        }

        function ProjectsPage() {
            return (
                <div className="projects-list">
                    <ProjectCard
                        title="BOXXP+"
                        subtitle="PWA / Web Application"
                        variant="pwa"
                        body={
                            <>
                                <Carousel
                                    images={[
                                        "../images/pwaSS1/spwa1.png",
                                        "../images/pwaSS1/spwa2.png",
                                        "../images/pwaSS1/spwa3.png",
                                        "../images/pwaSS1/spwa4.png",
                                        "../images/pwaSS1/spwa5.png",
                                        "../images/pwaSS1/spwa6.png",
                                    ]}
                                />
                            </>
                        }
                    />
                    <ProjectCard
                        title="BOXXP+"
                        subtitle="iOS+ Application"
                        variant="ios"
                    />
                </div>
            );
        }

        function App() {
            return (
                <div className="page-shell">
                    <Navbar activePage="projects" />
                    <ProjectsPage />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById("root"));
        root.render(<App />);

    </script>


</body>
</html>
